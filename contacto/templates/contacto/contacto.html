{% extends 'base.html' %}

{% block title %}
Entrega Final!
{% endblock %}

{% block content %}

{% if user.is_authenticated %}
    <form action="{% url 'logout' %}" method="post" style="display: inline;">
        {% csrf_token %}
    </form>
{% endif %}

<h2>Lista de Productos</h2>

<form method="get" action="{% url 'pagina_principal' %}">
    <input type="text" name="q" placeholder="Buscar productos" value="{{ query }}">
    <button type="submit">Buscar</button>
    <a href="{% url 'pagina_principal' %}" class="button">Limpiar filtro</a> <!-- Botón para limpiar el filtro -->
</form>

{% if productos %}
    <ul>
        {% for producto in productos %}
            <li>
                {{ producto.nombre_producto }} - {{ producto.precio }}
                <div id="detalle-{{ producto.id }}" style="display:none;">
                    <p>Fecha: {{ producto.fecha }}</p>
                    <p>Descripción: {{ producto.ver_mas }}</p>
                    <img src="{{ producto.imagen_url }}" alt="{{ producto.nombre_producto }}" style="width: 200px; height: auto;">
                </div>
                <a href="{% url 'ver_mas' producto.id %}" class="button">Ver más</a> <!-- Enlace Ver Más -->
                <a href="{% url 'editar_producto' producto.id %}" class="button">Editar</a> <!-- Enlace Editar -->
                <form action="{% url 'eliminar_producto' producto.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit">Eliminar</button>
                </form>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No se encontró ningún producto.</p>
{% endif %}

<a href="{% url 'crear_producto' %}" class="button">Agregar nuevo producto</a>

{% endblock %}
